<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Islombek's GitHub Page</title>
    <style>
        /* [Previous CSS remains exactly the same] */
        /* ... all your existing style rules ... */
    </style>
</head>
<body>
    <!-- Grade Calculator with new Apps Script URL -->
    <div class="grade-calculator">
        <h3>Calculated Grade</h3>
        <div class="grade-percentage">Loading...</div>
        <div class="grade-ratio">
            <div class="loading-spinner"></div>
        </div>
        <button class="refresh-button" title="Refresh grade data">â†»</button>
    </div>
    
    <div class="container">
        <!-- [Rest of your HTML remains the same] -->
        <!-- ... all your existing content ... -->
    </div>

    <script>
        // Updated JavaScript with new Apps Script URL
        document.addEventListener('DOMContentLoaded', function() {
            // [All your existing DOMContentLoaded code remains the same until the fetchGradeData function]
            
            // Updated fetchGradeData function with new URL
            function fetchGradeData() {
                const gradePercentage = document.querySelector('.grade-percentage');
                const gradeRatio = document.querySelector('.grade-ratio');
                
                gradePercentage.textContent = 'Loading...';
                gradeRatio.innerHTML = '<div class="loading-spinner"></div>';
                
                // YOUR NEW APPS SCRIPT URL
                const scriptUrl = 'https://script.google.com/macros/s/AKfycbz7_qtJ2m0ihXe709ieQVSsd3YRy8J9qkEQ-wAUpniC-6sAnmvGWRSWlcXE32iPPBpF/exec';
                
                fetch(`${scriptUrl}?t=${Date.now()}`)
                    .then(response => {
                        if (!response.ok) throw new Error('Network error');
                        return response.json();
                    })
                    .then(data => {
                        if (data && typeof data.percentage === 'number') {
                            updateGradeDisplay(data);
                        } else {
                            throw new Error('Invalid data format');
                        }
                    })
                    .catch(error => {
                        console.error('Error:', error);
                        gradePercentage.textContent = 'Error';
                        gradeRatio.textContent = 'Try again later';
                        setTimeout(fetchGradeData, 5000);
                    });
            }

            // Update grade display function (unchanged)
            function updateGradeDisplay(data) {
                document.querySelector('.grade-percentage').textContent = data.percentage.toFixed(2) + '%';
                document.querySelector('.grade-ratio').textContent = 
                    data.earnedPoints.toFixed(1) + ' / ' + data.totalPoints.toFixed(1);
                colorCodeGrade(data.percentage);
            }

            // [Rest of your existing JavaScript remains the same]
            // ... all your other functions and event listeners ...
            
            // Initialize grade data
            fetchGradeData();
        });

        // [All other supporting functions remain unchanged]
    </script>
</body>
</html>
